// Main SCSS entry point
@use 'bootstrap/scss/bootstrap';

// Import component styles
@use './components/TopHeader';
@use './components/Sidebar';
@use './components/MainContent';

/* ---------------------- Design tokens (CSS vars) ----------------------- */
:root {
  --header-bg: #ffffff;
  --header-border: #e0e0e0;
  --text-primary: #000000de;
  --text-secondary: #00000099;

  --shadow-elevation-1:
    0px 2px 1px -1px rgba(0, 0, 0, 0.2),
    0px 1px 1px 0px rgba(0, 0, 0, 0.14),
    0px 1px 3px 0px rgba(0, 0, 0, 0.12);

  /* Navigation color scheme - Blue-Gray Harmony (Option 3) */
  --nav-text-normal: #64748B;
  --nav-bg-hover: #F1F5F9;
  --nav-bg-active: #E0E7FF;
  --nav-text-active: #4338CA;
}

/* ---------------------- Base typography ------------------------------- */
html { font-size: 14px !important; }

body {
  font-size: 0.875rem !important;
  font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI',
    'Oxygen', 'Ubuntu', 'Cantarell', sans-serif !important;
}

/* ---------------------- Utilities & helpers --------------------------- */
.shadow-elevation-1 { box-shadow: var(--shadow-elevation-1); }
.min-h-0 { min-height: 0; }
.overflow-x-hidden { overflow-x: hidden; }
.transition-all { transition: all 0.3s ease; }

/* ---------------------- Drag and Drop Styles -------------------------- */
.dragging {
  opacity: 0.5;
  transform: scale(0.98);
}

[draggable="true"] {
  transition: opacity 0.2s ease, transform 0.2s ease;
}

[draggable="true"]:hover {
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}

/* ======================================================================
   Navigation States - Blue-Gray Harmony
   ====================================================================== */
.nav-item-button {
  color: var(--nav-text-normal) !important;
  background-color: transparent !important;
  transition: background-color 0.2s ease, color 0.2s ease !important;

  &:hover:not(.nav-item-active) {
    background-color: var(--nav-bg-hover) !important;
    color: var(--nav-text-normal) !important;
  }

  &.nav-item-active {
    background-color: var(--nav-bg-active) !important;
    color: var(--nav-text-active) !important;

    svg {
      color: var(--nav-text-active) !important;
    }
  }

  svg {
    color: var(--nav-text-normal);
    transition: color 0.2s ease;
  }
}

/* ======================================================================
   ChipCheck: Enhanced styling for better visual appeal
   ====================================================================== */
.chip-check-extra-tight {
  font-size: 0.75rem !important;
  padding: 0.375rem 0.75rem !important;
  line-height: 1.3 !important;
  min-height: 28px;
  border-radius: 14px !important;
  font-weight: 500 !important;
  transition: all 0.2s ease !important;
  letter-spacing: 0.01em;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);

  /* Hover effects for interactive chips */
  &:hover:not([style*="cursor: not-allowed"]) {
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  /* Active state enhancements */
  &.bg-primary {
    box-shadow: 0 2px 4px rgba(13, 110, 253, 0.25);

    &:hover {
      box-shadow: 0 3px 6px rgba(13, 110, 253, 0.35);
    }
  }

  /* Inactive state improvements */
  &.border-primary:not(.bg-primary) {
    background-color: rgba(13, 110, 253, 0.04);

    &:hover {
      background-color: rgba(13, 110, 253, 0.08);
    }
  }

  /* Responsive label switching */
  .chip-label-full {
    display: inline;
  }

  .chip-label-short {
    display: none;
  }

  @media (max-width: 1199.98px) {
    .chip-label-full {
      display: none;
    }

    .chip-label-short {
      display: inline;
    }
  }
}

/* Milestones section styling */
.milestones-section {
  margin-top: -0.5rem;
  padding-left: 0.75rem;

  .milestones-label {
    font-size: 0.8125rem !important;
    font-weight: 500 !important;
    color: #6c757d !important;
    letter-spacing: 0.02em;
    margin-bottom: 0.5rem !important;
  }

  .milestones-chips {
    gap: 0.5rem !important;
    flex-wrap: nowrap !important;

    /* Responsive adjustments for smaller screens */
    @media (max-width: 1399.98px) {
      gap: 0.375rem !important;
    }

    @media (max-width: 1199.98px) {
      gap: 0.25rem !important;
    }

    /* Make milestone chips smaller to fit on one line */
    .chip-check-extra-tight {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;

      /* Large screens and above - normal size */
      @media (min-width: 1400px) {
        font-size: 0.75rem !important;
        padding: 0.375rem 0.75rem !important;
        min-height: 28px;
      }

      /* XL screens - slight reduction */
      @media (max-width: 1399.98px) {
        font-size: 0.7rem !important;
        padding: 0.3rem 0.65rem !important;
        min-height: 26px;
      }

      /* Large screens - more reduction */
      @media (max-width: 1199.98px) {
        font-size: 0.625rem !important;
        padding: 0.25rem 0.5rem !important;
        min-height: 24px;
        letter-spacing: -0.01em;
      }

      /* Medium screens and below - minimum size */
      @media (max-width: 991.98px) {
        font-size: 0.5rem !important;
        padding: 0.2rem 0.4rem !important;
        min-height: 20px;
        letter-spacing: -0.02em;
      }
    }
  }
}

/* ======================================================================
   Custom Pill Button Padding - Compact but readable
   ====================================================================== */
.btn-pill-custom {
  padding: 0.25rem 0.625rem !important;
  font-size: 0.75rem !important;
  line-height: 1.5 !important;
  min-height: 28px !important;
  align-items: center !important;
  justify-content: center !important;
  font-weight: 500 !important;
  letter-spacing: 0.01em;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
  transition: all 0.2s ease !important;
  border: none !important;

  svg {
    flex-shrink: 0;
    display: inline-flex;
    align-items: center;
  }

  &:hover:not(:disabled) {
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  &:active:not(:disabled) {
    transform: translateY(0);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
  }

  &:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }

  &.btn-primary {
    box-shadow: 0 1px 3px rgba(13, 110, 253, 0.15);

    &:hover:not(:disabled) {
      box-shadow: 0 2px 6px rgba(13, 110, 253, 0.25);
    }
  }

  &.btn-success {
    box-shadow: 0 1px 3px rgba(25, 135, 84, 0.15);

    &:hover:not(:disabled) {
      box-shadow: 0 2px 6px rgba(25, 135, 84, 0.25);
    }
  }

  &.btn-warning {
    box-shadow: 0 1px 3px rgba(255, 193, 7, 0.15);

    &:hover:not(:disabled) {
      box-shadow: 0 2px 6px rgba(255, 193, 7, 0.25);
    }
  }

  &.btn-danger {
    box-shadow: 0 1px 3px rgba(220, 53, 69, 0.15);

    &:hover:not(:disabled) {
      box-shadow: 0 2px 6px rgba(220, 53, 69, 0.25);
    }
  }

  @media (max-width: 991.98px) {
    padding: 0.25rem 0.5rem !important;
    font-size: 0.7rem !important;
    min-height: 26px !important;
  }
}

/* ======================================================================
   Floating label: compact, border-chip style
   ====================================================================== */
.form-floating-compact {
  position: relative;

  > .form-control,
  > .form-select {
    height: auto !important;
    min-height: calc(1.5em + 0.75rem + 2px) !important;
    padding: var(--bs-form-control-padding-y, .375rem)
             var(--bs-form-control-padding-x, .75rem) !important;
    line-height: var(--bs-body-line-height, 1.5) !important;
  }

  > .form-control::placeholder { opacity: 1 !important; }

  > label {
    position: absolute !important;
    top: 0 !important;
    left: var(--bs-form-control-padding-x, .75rem) !important;
    transform: translateY(-50%) !important;
    margin: 0 !important;
    height: auto !important;
    padding: 0 .25rem !important;
    line-height: 1 !important;
    font-size: .75rem !important;
    background: #fff !important;
    color: var(--bs-secondary-color, #6c757d) !important;
    pointer-events: none !important;
    z-index: 3 !important;
    opacity: 1 !important;
  }

  > .form-control:focus ~ label,
  > .form-control:not(:placeholder-shown) ~ label,
  > .form-select ~ label {
    transform: translateY(-50%) !important;
    opacity: 1 !important;
  }
}


/* ======================================================================
   Callout Components - Custom styling to match design
   ====================================================================== */
.callout-default {
  background-color: #d1ecf1;
  color: #0c5460;
  border-left: 4px solid #0c5460;
  padding: 1rem 1.25rem;
  border-radius: 0.25rem;
  margin-bottom: 1rem;
  font-weight: 500;
}

.callout-warning {
  background-color: #fff3cd;
  color: #856404;
  border-left: 4px solid #856404;
  padding: 1rem 1.25rem;
  border-radius: 0.25rem;
  margin-bottom: 1rem;
  font-weight: 500;
}

.callout-danger {
  background-color: #f8d7da;
  color: #721c24;
  border-left: 4px solid #721c24;
  padding: 1rem 1.25rem;
  border-radius: 0.25rem;
  margin-bottom: 1rem;
  font-weight: 500;
}

/* ======================================================================
   Modal Header Improvements
   ====================================================================== */
/* ===== Floating label + inline validation icon (no helper space) ===== */
.form-floating-compact.with-feedback {
  /* Reserve space for our icon (constant, no shifts) */
  > .form-control,
  > .form-select {
    padding-right: 2rem !important;
  }

  /* Force the SAME padding even when Bootstrap applies its validation states */
  > .form-control.is-valid,
  > .form-control.is-invalid,
  > .form-select.is-valid,
  > .form-select.is-invalid {
    padding-right: 2rem !important;       /* kill Bootstrap's dynamic PR */
    background-image: none !important;     /* kill built-in check/x icon */
  }

  /* Our icon inside the control */
  .validation-icon {
    position: absolute;
    right: .5rem;
    top: 50%;
    transform: translateY(-50%);
    z-index: 4;
    cursor: help;
    line-height: 1;
    display: inline-flex;
    align-items: center;
    pointer-events: auto;
    will-change: transform; /* smoother paint when popover opens */
  }

  /* Avoid the native select chevron */
  &.for-select .validation-icon { right: 2rem; }
}

/* ======================================================================
   Card Header Responsive Improvements
   ====================================================================== */
.card-header {
  /* Ensure header items wrap properly and don't overflow */
  flex-wrap: wrap;
  min-width: 0;

  /* Prevent title from overflowing */
  .card-title {
    min-width: 0;
    flex-shrink: 1;
  }

  /* Ensure action buttons container doesn't overflow */
  .ms-auto {
    flex-shrink: 0;
    min-width: fit-content;
  }
}

/* Responsive header actions visibility */
.card-header-actions-responsive {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  flex-shrink: 0;

  /* Hide individual action buttons on medium screens and below, show menu */
  .header-action-buttons {
    display: flex;
    gap: 0.75rem;

    @media (max-width: 991.98px) {
      display: none;
    }
  }

  /* Show menu on medium screens and below */
  .header-action-menu {
    display: none;

    @media (max-width: 991.98px) {
      display: inline-block;
    }
  }

  /* Chevron always visible */
  .header-chevron {
    margin-left: 0.5rem;
  }
}

/* ======================================================================
   Modal Backdrop - Layered backdrop system for nested modals
   ====================================================================== */
.modal-backdrop.show {
  opacity: 0.75 !important;
  background-color: rgba(33, 37, 41, 0.9) !important;
}

/* Hide the backdrop only for the first fullscreen modal (adjacent sibling) */
.modal-fullscreen + .modal-backdrop {
  opacity: 0 !important;
}

/* Target backdrops with higher z-index (stacked modals)
   Bootstrap's default modal z-index is 1055, backdrop is 1050
   Second modal z-index is 1065, backdrop is 1060 */
.modal-backdrop.show[style*="z-index: 1060"],
.modal-backdrop.show[style*="z-index: 1070"],
.modal-backdrop.show[style*="z-index: 1080"] {
  opacity: 1 !important;
  background-color: rgba(52, 58, 64, 0.85) !important;
}

/* ======================================================================
   Standard Table - Enhanced styling (used by default)
   ====================================================================== */
.standard-table,
.jobs-table {
  border-collapse: separate !important;
  border-spacing: 0 !important;

  thead {
    th {
      position: sticky !important;
      top: 0 !important;
      z-index: 10 !important;
      background: linear-gradient(180deg, #f8f9fa 0%, #e9ecef 100%) !important;
      border-bottom: 2px solid #dee2e6 !important;
      border-top: 1px solid #dee2e6 !important;
      font-weight: 600 !important;
      font-size: 0.8125rem !important;
      text-transform: uppercase;
      letter-spacing: 0.025em;
      color: #495057 !important;
      padding: 0.875rem 1rem !important;
      white-space: nowrap;
      vertical-align: middle !important;

      &:first-child {
        border-left: 1px solid #dee2e6;
      }

      &:last-child {
        border-right: 1px solid #dee2e6;
      }
    }
  }

  tbody {
    tr {
      border-bottom: 1px solid #e9ecef;
      transition: background-color 0.2s ease;

      &:hover {
        background-color: #f1f5f9 !important;

        td {
          background-color: #f1f5f9 !important;
        }
      }

      td {
        padding: 0.875rem 1rem !important;
        vertical-align: middle !important;
        font-size: 0.8125rem !important;
        transition: background-color 0.2s ease;
      }

      &:last-child td {
        border-bottom: 1px solid #dee2e6;
      }
    }
  }
}

/* Override Bootstrap's striped table styling for standard tables */
.standard-table.table-striped > tbody > tr:nth-of-type(odd) > *,
.jobs-table.table-striped > tbody > tr:nth-of-type(odd) > * {
  --bs-table-bg-type: #f8fafc !important;
  background-color: #f8fafc !important;
}

.standard-table.table-striped > tbody > tr:nth-of-type(even) > *,
.jobs-table.table-striped > tbody > tr:nth-of-type(even) > * {
  --bs-table-bg-type: #ffffff !important;
  background-color: #ffffff !important;
}

/* Hover effect for standard tables - must be more specific to override striped styles */
.standard-table.table-striped > tbody > tr:hover > *,
.jobs-table.table-striped > tbody > tr:hover > * {
  --bs-table-bg-type: #e2e8f0 !important;
  background-color: #e2e8f0 !important;
}

/* ======================================================================
   Contacts Table - Enhanced styling
   ====================================================================== */
.contacts-table {
  border-collapse: separate !important;
  border-spacing: 0 !important;

  thead {
    th {
      position: sticky !important;
      top: 0 !important;
      background: linear-gradient(180deg, #f8f9fa 0%, #e9ecef 100%) !important;
      border-bottom: 2px solid #dee2e6 !important;
      border-top: 1px solid #dee2e6 !important;
      font-weight: 600 !important;
      font-size: 0.8125rem !important;
      text-transform: uppercase;
      letter-spacing: 0.025em;
      color: #495057 !important;
      padding: 0.875rem 1rem !important;
      white-space: nowrap;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
      z-index: 100 !important;

      &:first-child {
        border-left: 1px solid #dee2e6;
      }

      &:last-child {
        border-right: 1px solid #dee2e6;
      }

      &.position-sticky {
        z-index: 110 !important;
      }

      &[role="button"] {
        transition: background-color 0.15s ease, color 0.15s ease;

        &:hover {
          background: linear-gradient(180deg, #e9ecef 0%, #dde0e3 100%) !important;
          color: #212529 !important;
        }
      }
    }
  }

  tbody {
    tr {
      border-bottom: 1px solid #e9ecef;
      transition: background-color 0.15s ease, box-shadow 0.15s ease;

      &:hover {
        background-color: #e8f0fe !important;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);

        td {
          background-color: #e8f0fe !important;
        }
      }

      &:nth-child(even) {
        background-color: #ffffff;

        td {
          background-color: #ffffff;
        }
      }

      &:nth-child(odd) {
        background-color: #f8fafc;

        td {
          background-color: #f8fafc;
        }
      }

      td {
        padding: 0.875rem 1rem !important;
        vertical-align: middle !important;
        font-size: 0.8125rem !important;
        transition: background-color 0.15s ease;

        &.position-sticky {
          box-shadow: 2px 0 4px rgba(0, 0, 0, 0.06);
          z-index: 50;

          &.start-0 {
            z-index: 51;
          }
        }
      }

      &:last-child td {
        border-bottom: 1px solid #dee2e6;
      }
    }
  }
}

/* ======================================================================
   Responsive Improvements for Filter and Search Inputs
   ====================================================================== */
@media (max-width: 1199.98px) {
  .contacts-header-filters {
    .filter-select-wrapper {
      width: 180px !important;
    }

    .search-input-wrapper {
      width: 220px !important;
    }
  }
}

@media (max-width: 991.98px) {
  .contacts-header-filters {
    .filter-select-wrapper {
      width: 160px !important;
    }

    .search-input-wrapper {
      width: 200px !important;
    }
  }
}

@media (max-width: 767.98px) {
  .contacts-header-filters {
    width: 100% !important;

    .filter-select-wrapper,
    .search-input-wrapper {
      width: 100% !important;
      max-width: none !important;
    }
  }
}

/* ======================================================================
   Print Styles - For PDF Generation
   ====================================================================== */
@media print {
  /* Hide everything except the modal content */
  body * {
    visibility: hidden;
  }

  /* Show only the modal and its contents */
  .modal,
  .modal * {
    visibility: visible;
  }

  /* Position modal properly for printing */
  .modal {
    position: absolute !important;
    left: 0 !important;
    top: 0 !important;
    margin: 0 !important;
    padding: 0 !important;
    overflow: visible !important;
  }

  .modal-dialog {
    max-width: 100% !important;
    margin: 0 !important;
    transform: none !important;
  }

  .modal-content {
    border: none !important;
    box-shadow: none !important;
  }

  /* Hide interactive elements */
  .print-hide,
  .btn-close,
  .modal-backdrop {
    display: none !important;
    visibility: hidden !important;
  }

  /* Optimize layout for printing */
  .modal-header {
    border-bottom: 2px solid #dee2e6 !important;
    padding: 1rem !important;
  }

  .modal-body {
    padding: 1rem !important;
  }

  /* Ensure tables print properly */
  table {
    page-break-inside: auto;
  }

  tr {
    page-break-inside: avoid;
    page-break-after: auto;
  }

  thead {
    display: table-header-group;
  }

  /* Remove background colors for better printing */
  .table-light,
  .table-secondary,
  .bg-light {
    background-color: #f8f9fa !important;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }

  /* Keep badge colors */
  .badge {
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }

  /* Ensure proper page margins */
  @page {
    margin: 0.5in;
    size: letter;
  }
}
